

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. Loops and program syntax &#8212; Stata Programming</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapter3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Advanced file management" href="chapter4.html" />
    <link rel="prev" title="2. Return values, macros, programs" href="chapter2.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="https://brand.jhu.edu/assets/uploads/sites/5/2014/06/university_logo_small_vertical_blue.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Preface
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chapter1.html">1. Overview, commands, syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter2.html">2. Return values, macros, programs</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Loops and program syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter4.html">4. Advanced file management</a></li>
<li class="toctree-l1"><a class="reference internal" href="chapter5.html">5. Graphs</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickrefs.html">Quick References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fchapter3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/chapter3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Loops and program syntax</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">3.1 Loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-numeric-values">3.1.1 Over numeric values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-string-values">3.1.2 Over string values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-syntax">3.2 program syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfirst">3.2.1 myfirst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mysecond">3.2.2 mysecond</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mythird">3.2.3 mythird</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfourth">3.2.4. myfourth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfifth">3.2.5. myfifth</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="loops-and-program-syntax">
<h1>3. Loops and program syntax<a class="headerlink" href="#loops-and-program-syntax" title="Permalink to this heading">#</a></h1>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">#import numpy as np</span>
<span class="c1">#import sklearn as skl</span>
<span class="c1"># </span>

<span class="c1">#plt.figure(figsize=[2, 2])</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">550</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;system&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">550</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">960</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span>  <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">950</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;ado&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;do&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">550</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;dta&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1900</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">4000</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;word&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1900</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="o">-</span><span class="mi">475</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;publish&quot;</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">950</span><span class="p">))</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([</span> <span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span><span class="s2">&quot;ado&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;syntax&quot;</span><span class="p">,</span> <span class="s2">&quot;do&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;ado&quot;</span><span class="p">,</span> <span class="s2">&quot;command&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;do&quot;</span><span class="p">,</span> <span class="s2">&quot;queue&quot;</span><span class="p">)</span> <span class="p">])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;command&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;queue&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;excel&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;word&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;html&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;dta&quot;</span><span class="p">),(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span><span class="s2">&quot;log&quot;</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="s2">&quot;dta&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;log&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;word&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">),(</span><span class="s2">&quot;html&quot;</span><span class="p">,</span><span class="s2">&quot;publish&quot;</span><span class="p">)])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> 
        <span class="n">nx</span><span class="o">.</span><span class="n">get_node_attributes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">),</span> 
        <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> 
        <span class="n">node_size</span> <span class="o">=</span> <span class="mi">4500</span><span class="p">,</span>
        <span class="n">node_color</span> <span class="o">=</span> <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span>
        <span class="n">linewidths</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">collections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;#000000&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/cf897162df8cde377a32eb942eea0152ade328c27161cecc7805ebaa9c2a1742.png" src="_images/cf897162df8cde377a32eb942eea0152ade328c27161cecc7805ebaa9c2a1742.png" />
</div>
</div>
<p>By now you should be aware that our key ambitions are to:</p>
<ol class="arabic simple">
<li><p>Learn the commands and syntax that generate output, typically for statistical inference</p></li>
<li><p>Identify the names of the <code class="docutils literal notranslate"><span class="pre">c()</span></code>, <code class="docutils literal notranslate"><span class="pre">r()</span></code>, or <code class="docutils literal notranslate"><span class="pre">e()</span></code> class <u>system-defined</u> macros that define key parameters in our output</p></li>
<li><p>Format these values to fit aesthetic, publication, or editorial criteria and save them as <u>user-defined</u> macros</p></li>
<li><p>Embed the macros into text, graph, or file (.xlsx, .log, .dta, .docx, .html)</p></li>
<li><p>Achieve these aims in a workflow that is automated, collaborative, open, reproducible, legible, user-friendly, and therefore <strong>rigorous</strong></p></li>
</ol>
<p>Today we are going to focus on commands and syntax that exponentially increase our efficiency in coding, a key step towards automation. One way to achieve this is by learning about loops. The other is by writing flexible programs that are driven by user-defined inputs.</p>
<section id="loops">
<h2>3.1 Loops<a class="headerlink" href="#loops" title="Permalink to this heading">#</a></h2>
<section id="over-numeric-values">
<h3>3.1.1 Over numeric values<a class="headerlink" href="#over-numeric-values" title="Permalink to this heading">#</a></h3>
<p>Take this code snippet for instance</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">forvalues</span> i = <span class="m">1</span><span class="o">/</span><span class="m">26</span> {
<span class="k">    di</span> <span class="nv">`i&#39;</span>
}
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> forvalues</span> i =	<span class="m">1</span><span class="o">/</span><span class="m">26</span>	{
<span class="m">2</span>.    <span class="k"> di</span> <span class="nv">`i&#39;</span>
<span class="m">3</span>. }
<span class="m">1</span>
<span class="m">2</span>
<span class="m">3</span>
<span class="m">4</span>
<span class="m">5</span>
<span class="m">6</span>
<span class="m">7</span>
<span class="m">8</span>
<span class="m">9</span>
<span class="m">10</span>
<span class="m">11</span>
<span class="m">12</span>
<span class="m">13</span>
<span class="m">14</span>
<span class="m">15</span>
<span class="m">16</span>
<span class="m">17</span>
<span class="m">18</span>
<span class="m">19</span>
<span class="m">20</span>
<span class="m">21</span>
<span class="m">22</span>
<span class="m">23</span>
<span class="m">24</span>
<span class="m">25</span>
<span class="m">26</span>

. 
</pre></div>
</div>
<p><img alt="" src="_images/forvalues_chatGPT.png" /></p>
<p>And take this one:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	di</span> <span class="nv">`v&#39;</span>
}
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> use</span> transplants,<span class="k"> clear</span>

.<span class="k"> foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span>	{
<span class="m">2</span>.        <span class="k"> di</span> <span class="nv">`v&#39;</span>
<span class="m">3</span>. }
<span class="m">1</span>
<span class="m">12</span>
<span class="m">18551.324</span>
<span class="m">177</span>
<span class="m">79</span>
<span class="m">2</span>
<span class="m">0</span>
<span class="m">9</span>
<span class="m">4</span>
<span class="m">157.48</span>
<span class="m">69.58</span>
<span class="m">28</span>
<span class="m">0</span>
<span class="m">56</span>
<span class="m">28</span>
<span class="m">20421.895</span>
<span class="m">0</span>
<span class="m">1</span>
<span class="m">5.1937032</span>
<span class="m">4</span>
<span class="m">1</span>
<span class="m">0</span>
<span class="m">0</span>
<span class="m">1</span>
<span class="m">1</span>
REFLUX NEPHROPATHY

. 
</pre></div>
</div>
<p><img alt="" src="_images/forvalues2_chatGPT.png" /></p>
</section>
<section id="over-string-values">
<h3>3.1.2 Over string values<a class="headerlink" href="#over-string-values" title="Permalink to this heading">#</a></h3>
<p>Let’s make a subtle modification to the code snippet above:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>
}
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> use</span> transplants,<span class="k"> clear</span>

.<span class="k"> foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span>	{
<span class="m">2</span>.        <span class="k"> di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>
<span class="m">3</span>. }
fake_id
ctr_id
transplant_date
don_hgt_cm
don_wgt_kg
don_cod
don_ecd
dx
race
rec_hgt_cm
rec_wgt_kg
bmi
prev_ki
age
peak_pra
end_date
died
tx_failed
wait_yrs
abo
gender
rec_hcv_antibody
rec_work
pretx_cmv
rec_education
extended_dgn

. 
</pre></div>
</div>
<p>The code you provided loads a dataset named “transplants” and then iterates over all the variables in that dataset using a foreach loop.</p>
<p>Within each iteration of the loop, the di command is used to display the name of the current variable v.</p>
<p>Based on the output you provided, it seems that the dataset “transplants” contains a list of variable names. The code successfully printed the names of each variable in the dataset, with one variable name displayed per line. The variable names include “fake_id”, “ctr_id”, “transplant_date”, “don_hgt_cm”, “don_wgt_kg”, and so on.</p>
<p>The code snippet you provided successfully displays the names of the variables in the dataset “transplants”.</p>
<p>– chatGPT</p>
<p>What is the output:code ratio in these two examples I’ve given? Might that be a crude metric of efficiency?</p>
<p>Consider the following code snippet:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;died&quot;</span> | <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span><span class="s">&quot;extended_dgn&quot;</span> {
<span class="k">	    capture logistic</span> died <span class="nv">`v&#39;</span>
<span class="k">	    capture lincom</span> <span class="nv">`v&#39;</span>
<span class="k">	    scalar</span> p = <span class="nf">r</span>(p)
<span class="k">	    di</span> <span class="s">&quot;p-value for </span><span class="nv">`v&#39;</span><span class="s"> : &quot;</span> p 	
	}
<span class="k">	else</span> {
<span class="k">		di</span> <span class="s">&quot; &quot;</span>
	}
	
	
}
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> use</span> transplants,<span class="k"> clear</span>

.<span class="k"> foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="m">2</span>.        <span class="k"> if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;died&quot;</span>  <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span><span class="s">&quot;extended_dgn&quot;</span>	{
<span class="m">3</span>.            <span class="k"> capture logistic</span> died <span class="nv">`v&#39;</span>
<span class="m">4</span>.            <span class="k"> capture lincom</span> <span class="nv">`v&#39;</span>
<span class="m">5</span>.            <span class="k"> scalar</span> p = <span class="nf">r</span>(p)
<span class="m">6</span>.            <span class="k"> di</span> <span class="s">&quot;p-value for </span><span class="nv">`v&#39;</span><span class="s"> : &quot;</span> p   
<span class="m">7</span>.         }
<span class="m">8</span>.        <span class="k"> else</span> {
<span class="m">9</span>.                <span class="k"> di</span> <span class="s">&quot; &quot;</span>
<span class="m">10</span>.         }
<span class="m">11</span>.         
.         
. }
p<span class="o">-</span>value<span class="k"> for</span> fake_id : .<span class="m">46371117</span>
p<span class="o">-</span>value<span class="k"> for</span> ctr_id : .<span class="m">52178434</span>
p<span class="o">-</span>value<span class="k"> for</span> transplant_date : <span class="m">2.926e-24</span>
p<span class="o">-</span>value<span class="k"> for</span> don_hgt_cm : .<span class="m">93751316</span>
p<span class="o">-</span>value<span class="k"> for</span> don_wgt_kg : .<span class="m">49371195</span>
p<span class="o">-</span>value<span class="k"> for</span> don_cod : .<span class="m">25255576</span>
p<span class="o">-</span>value<span class="k"> for</span> don_ecd : <span class="m">6.736e-13</span>
p<span class="o">-</span>value<span class="k"> for</span> dx : .<span class="m">00894634</span>
p<span class="o">-</span>value<span class="k"> for</span> race : .<span class="m">00028468</span>
p<span class="o">-</span>value<span class="k"> for</span> rec_hgt_cm : .<span class="m">01878141</span>
p<span class="o">-</span>value<span class="k"> for</span> rec_wgt_kg : .<span class="m">10279242</span>
p<span class="o">-</span>value<span class="k"> for</span> bmi : .<span class="m">67785746</span>
p<span class="o">-</span>value<span class="k"> for</span> prev_ki : .<span class="m">02051579</span>
p<span class="o">-</span>value<span class="k"> for</span> age : <span class="m">1.648e-20</span>
p<span class="o">-</span>value<span class="k"> for</span> peak_pra : .<span class="m">02585959</span>
p<span class="o">-</span>value<span class="k"> for</span> end_date : <span class="m">2.891e-63</span>
p<span class="o">-</span>value<span class="k"> for</span> died : .
p<span class="o">-</span>value<span class="k"> for</span> tx_failed : .
p<span class="o">-</span>value<span class="k"> for</span> wait_yrs : .<span class="m">49225994</span>
p<span class="o">-</span>value<span class="k"> for</span> abo : .<span class="m">03522145</span>
p<span class="o">-</span>value<span class="k"> for</span> gender : .<span class="m">10388923</span>
p<span class="o">-</span>value<span class="k"> for</span> rec_hcv_antibody : .<span class="m">02039008</span>
p<span class="o">-</span>value<span class="k"> for</span> rec_work : .<span class="m">00018548</span>
p<span class="o">-</span>value<span class="k"> for</span> pretx_cmv : .<span class="m">17525206</span>
p<span class="o">-</span>value<span class="k"> for</span> rec_education : .<span class="m">47738727</span>
p<span class="o">-</span>value<span class="k"> for</span> extended_dgn : .
</pre></div>
</div>
<p><img alt="" src="_images/chatGPT1.png" /></p>
<p><img alt="" src="_images/chatgpt4.png" /></p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">local</span> decimal_format <span class="s">&quot;%.2f&quot;</span>

<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;died&quot;</span> <span class="o">&amp;</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;extended_dgn&quot;</span> {
<span class="k">        capture logistic</span> died <span class="nv">`v&#39;</span>
<span class="k">        capture lincom</span> <span class="nv">`v&#39;</span>
<span class="k">        scalar</span> p = <span class="nf">r</span>(p)
<span class="k">        </span>
<span class="k">        local</span> p_value_label <span class="s">&quot;&quot;</span>
<span class="k">        </span>
<span class="k">        if</span> p <span class="o">&lt;</span> <span class="m">0.01</span> {
<span class="k">            local</span> p_value_label <span class="s">&quot;p&lt;0.01&quot;</span>
        }
<span class="k">        else if</span> p <span class="o">&lt;=</span> <span class="m">0.05</span> {
<span class="k">            local</span> p_value_label <span class="nf">string</span>(<span class="nf">round</span>(p, <span class="m">0.01</span>))
        }
<span class="k">        else</span> {
<span class="k">            local</span> p_value_label <span class="nf">string</span>(<span class="nf">round</span>(p, <span class="m">0.1</span>))
        }
<span class="k">        </span>
<span class="k">        di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s"> : &quot;</span> <span class="nv">`p_value_label&#39;</span>
    }
<span class="k">    else</span> {
<span class="k">        di</span> <span class="s">&quot; &quot;</span>
    }
}
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> local</span> decimal_format <span class="s">&quot;%.2f&quot;</span>

. 
.<span class="k"> foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="m">2</span>.    <span class="k"> if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;died&quot;</span> <span class="o">&amp;</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;extended_dgn&quot;</span> {
<span class="m">3</span>.        <span class="k"> capture logistic</span> died <span class="nv">`v&#39;</span>
<span class="m">4</span>.        <span class="k"> capture lincom</span> <span class="nv">`v&#39;</span>
<span class="m">5</span>.        <span class="k"> scalar</span> p = <span class="nf">r</span>(p)
<span class="m">6</span>.         
.        <span class="k"> local</span> p_value_label <span class="s">&quot;&quot;</span>
<span class="m">7</span>.         
.        <span class="k"> if</span> p <span class="o">&lt;</span> <span class="m">0.01</span> {
<span class="m">8</span>.            <span class="k"> local</span> p_value_label <span class="s">&quot;p&lt;0.01&quot;</span>
<span class="m">9</span>.         }
<span class="m">10</span>.        <span class="k"> else if</span> p <span class="o">&lt;=</span> <span class="m">0.05</span> {
<span class="m">11</span>.            <span class="k"> local</span> p_value_label <span class="nf">string</span>(<span class="nf">round</span>(p, <span class="m">0.01</span>))
<span class="m">12</span>.         }
<span class="m">13</span>.        <span class="k"> else</span> {
<span class="m">14</span>.            <span class="k"> local</span> p_value_label <span class="nf">string</span>(<span class="nf">round</span>(p, <span class="m">0.1</span>))
<span class="m">15</span>.         }
<span class="m">16</span>.         
.        <span class="k"> di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s"> : &quot;</span> <span class="nv">`p_value_label&#39;</span>
<span class="m">17</span>.     }
<span class="m">18</span>.    <span class="k"> else</span> {
<span class="m">19</span>.        <span class="k"> di</span> <span class="s">&quot; &quot;</span>
<span class="m">20</span>.     }
<span class="m">21</span>. }
fake_id : .<span class="m">5</span>
ctr_id : .<span class="m">5</span>
transplant_date : <span class="m">1</span>
don_hgt_cm : .<span class="m">9</span>
don_wgt_kg : .<span class="m">5</span>
don_cod : .<span class="m">3</span>
don_ecd : <span class="m">1</span>
dx : <span class="m">1</span>
race : <span class="m">1</span>
rec_hgt_cm : .<span class="m">02</span>
rec_wgt_kg : .<span class="m">1</span>
bmi : .<span class="m">7</span>
prev_ki : .<span class="m">02</span>
age : <span class="m">1</span>
peak_pra : .<span class="m">03</span>
end_date : <span class="m">1</span>

tx_failed : .
wait_yrs : .<span class="m">5</span>
abo : .<span class="m">04</span>
gender : .<span class="m">1</span>
rec_hcv_antibody : .<span class="m">02</span>
rec_work : <span class="m">1</span>
pretx_cmv : .<span class="m">2</span>
rec_education : .<span class="m">5</span>
</pre></div>
</div>
<p><img alt="" src="_images/chatGPT6.png" /></p>
<p>And so you can use AI as an assistant or copilot for labs, work, and fun:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>

<span class="k">local</span> decimal_format <span class="s">&quot;%.2f&quot;</span>

<span class="c1">// Create an empty Excel file</span>
putexcel<span class="k"> set</span> results<span class="m">.</span>xlsx,<span class="k"> replace</span>

<span class="c1">// Write variable names and formatted p-values to Excel</span>
putexcel A1 = <span class="s">&quot;Variable&quot;</span> B1 = <span class="s">&quot;p-value&quot;</span>

<span class="k">local</span> row = <span class="m">2</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">    if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;died&quot;</span> <span class="o">&amp;</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">!=</span> <span class="s">&quot;extended_dgn&quot;</span> {
<span class="k">        capture logistic</span> died <span class="nv">`v&#39;</span>
<span class="k">        capture lincom</span> <span class="nv">`v&#39;</span>
<span class="k">        scalar</span> p = <span class="nf">r</span>(p)
<span class="k">        </span>
<span class="k">        local</span> p_value_label <span class="s">&quot;&quot;</span>
<span class="k">        </span>
<span class="k">        if</span> p <span class="o">&lt;</span> <span class="m">0.01</span> {
<span class="k">            local</span> p_value_label <span class="s">&quot;p&lt;0.01&quot;</span>
        }
<span class="k">        else if</span> p <span class="o">&lt;=</span> <span class="m">0.05</span> {
<span class="k">            local</span> p_value_label:<span class="k"> di</span> <span class="nx">%3.2f</span> p
        }
<span class="k">        else</span> {
<span class="k">            local</span> p_value_label:<span class="k"> di</span> <span class="nx">%2.1f</span> p
        }
        
        putexcel A<span class="nv">`row&#39;</span> = <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span>
        putexcel B<span class="nv">`row&#39;</span> = <span class="s">&quot;</span><span class="nv">`p_value_label&#39;</span><span class="s">&quot;</span> 
<span class="k">        </span>
<span class="k">        local</span> row = <span class="nv">`row&#39;</span> <span class="o">+</span> <span class="m">1</span>
    }
}

<span class="c1">// Save and close the Excel file</span>
putexcel<span class="k"> close</span>
</pre></div>
</div>
<p>Let’s build our skills even further by introducing some powerful and new commands:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> transplants,<span class="k"> clear</span>
<span class="k">foreach</span> v of<span class="k"> varlist</span> <span class="o">*</span> {
<span class="k">	qui ds</span>, has(type string)
<span class="k">	if</span> <span class="nf">r</span>(varlist) <span class="o">==</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> {
<span class="k">		 di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s"> is a string&quot;</span>
	}
<span class="k">	else if</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s">&quot;</span> <span class="o">==</span> <span class="s">&quot;died&quot;</span> {
<span class="k">		di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s"> is the outcome&quot;</span>
	}
<span class="k">	else</span> {
<span class="k">		di</span> <span class="s">&quot;</span><span class="nv">`v&#39;</span><span class="s"> is numeric&quot;</span>
<span class="k">		logistic</span> died <span class="nv">`v&#39;</span>
<span class="k">		di</span> _b[<span class="nv">`v&#39;</span>]
	}
	
}
</pre></div>
</div>
<p>Based on the code you provided, it appears that you want to iterate over each variable in the “transplants” dataset and perform different actions based on whether the variable is numeric, string, or the outcome variable “died”. Additionally, for numeric variables, you want to fit a logistic regression model and display the coefficient.</p>
<p>This code snippet checks whether the variable is a string or the outcome variable “died” using the ds command. If it is a string, it displays a message indicating that it is a string variable. If it is the outcome variable “died”, it displays a message indicating that it is the outcome variable. If it is a numeric variable, it fits a logistic regression model with “died” as the dependent variable and v as the independent variable. It then displays the coefficient of v using _b[v’]`.</p>
<p>– chatGPT (because I don’t enjoy annotating my code!!!)</p>
</section>
</section>
<section id="program-syntax">
<h2>3.2 program syntax<a class="headerlink" href="#program-syntax" title="Permalink to this heading">#</a></h2>
<p>We wrote our first program on Monday and today we should build on that foundation.</p>
<section id="myfirst">
<h3>3.2.1 myfirst<a class="headerlink" href="#myfirst" title="Permalink to this heading">#</a></h3>
<p>Remember the program? The quickest way to locate it among the sytem ado-files is as follows:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">which</span> myfirst
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> which</span> myfirst
<span class="o">/</span>Applications<span class="o">/</span>Stata<span class="o">/</span>ado<span class="o">/</span>base<span class="o">/</span>m<span class="o">/</span>myfirst<span class="m">.</span>ado

. 
</pre></div>
</div>
<p>Here it is:</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">program</span> define myfirst
<span class="k">   display</span> <span class="s">&quot;Hello, class!&quot;</span>
<span class="k">end</span> 

myfirst
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>. myfirst
Hello,<span class="k"> class</span><span class="o">!</span>

. 
</pre></div>
</div>
</section>
<section id="mysecond">
<h3>3.2.2 mysecond<a class="headerlink" href="#mysecond" title="Permalink to this heading">#</a></h3>
<p>Consider the following program. No, its not your second. We are going to use it as a springboard for many other programs. This Program enables a user with Stata versions before 16 (i.e., c(version) &lt; 17) to extract macros for beta p-values and 95%CI after a regression. W</p>
<p>While troubleshooting, we learned yesterday that Stata version 15 and earlier return only r(estimate) and r(se) after <code class="docutils literal notranslate"><span class="pre">regression</span></code> and <code class="docutils literal notranslate"><span class="pre">lincom</span></code> commands. So might we be able to provide the additional macros including p-values and 95%CI via a program we write?</p>
<p>The answer is an emphatic yes! And here is such a program. I lay it out here just so you can test it. But we will gradually build our skills from a simple premise to this level of sophistication.</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> stata13
<span class="k">program</span> define stata13
<span class="k">    syntax varlist</span>,<span class="k"> test</span>(numlist)
<span class="k">	</span>
<span class="k">	local</span> y:<span class="k"> di</span> <span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>,<span class="m">1</span>)
<span class="k">	if</span> <span class="nv">`test&#39;</span> <span class="o">==</span> <span class="m">1</span> {
<span class="k">		di in</span> red <span class="s">&quot;The outcome can&#39;t be tested!&quot;</span>
<span class="k">		exit</span> <span class="m">340</span>
	}
<span class="k">	noi logistic</span> <span class="nv">`varlist&#39;</span>
<span class="k">	local</span> x<span class="nv">`test&#39;</span>:<span class="k"> di</span> <span class="nf">word</span>(<span class="s">&quot;</span><span class="nv">`varlist&#39;</span><span class="s">&quot;</span>,<span class="nv">`test&#39;</span>)	
	cls
<span class="k">	scalar</span> z = _b[<span class="nv">`x`test&#39;&#39;</span>]<span class="o">/</span>_se[<span class="nv">`x`test&#39;&#39;</span>]
<span class="k">	noi di</span> <span class="s">&quot;z statistic for </span><span class="nv">`x`test&#39;&#39;</span><span class="s">: &quot;</span> z
<span class="k">	scalar</span> p = <span class="m">2</span><span class="o">*</span>(<span class="m">1</span><span class="o">-</span><span class="nf">normal</span>(<span class="nf">abs</span>(z)))
<span class="k">	noi di</span> <span class="s">&quot;p-value for </span><span class="nv">`x`test&#39;&#39;</span><span class="s">: &quot;</span> p 
<span class="k">	di</span> <span class="s">&quot;lower bound of 95% CI for </span><span class="nv">`x`test&#39;&#39;</span><span class="s">: &quot;</span> <span class="nf">exp</span>(_b[<span class="nv">`x`test&#39;&#39;</span>]<span class="o">+</span><span class="nf">invnormal</span>(<span class="m">0.025</span>) <span class="o">*</span> _se[<span class="nv">`x`test&#39;&#39;</span>])
<span class="k">	di</span> <span class="s">&quot;upper bound of 95% CI for </span><span class="nv">`x`test&#39;&#39;</span><span class="s">: &quot;</span> <span class="nf">exp</span>(_b[<span class="nv">`x`test&#39;&#39;</span>]<span class="o">+</span><span class="nf">invnormal</span>(<span class="m">0.975</span>) <span class="o">*</span> _se[<span class="nv">`x`test&#39;&#39;</span>])	
<span class="k">	lincom</span> <span class="nv">`x`test&#39;&#39;</span>

<span class="k">end</span> 

<span class="k">use</span> transplants,<span class="k"> clear</span> 
stata13 died prev age gender race dx bmi peak_pra don_ecd wait_yrs,<span class="k"> test</span>(<span class="m">4</span>)
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> use</span> transplants,<span class="k"> clear</span> 

. stata13 died prev age gender race dx bmi peak_pra don_ecd wait_yrs,<span class="k"> test</span>(<span class="m">4</span>)

Logistic regression                                     Number of obs =  <span class="m">1</span>,<span class="m">518</span>
                                                        LR <span class="nf">chi2</span>(<span class="m">9</span>)    = <span class="m">114.86</span>
                                                        Prob <span class="o">&gt;</span> chi2   = <span class="m">0.0000</span>
Log likelihood = <span class="o">-</span><span class="m">518.87252</span>                             Pseudo R2     = <span class="m">0.0996</span>

<span class="o">------------------------------------------------------------------------------</span>
        died | Odds<span class="k"> ratio</span>   Std.<span class="k"> err</span>.      z    P<span class="o">&gt;</span>|z|     [<span class="m">95</span>%<span class="k"> conf</span>. interval]
<span class="o">-------------+----------------------------------------------------------------</span>
     prev_ki |    .<span class="m">941235</span>   .<span class="m">3097531</span>    <span class="o">-</span><span class="m">0.18</span>   <span class="m">0.854</span>     .<span class="m">4938263</span>    <span class="m">1.793998</span>
         age |   <span class="m">1.052174</span>   .<span class="m">0078088</span>     <span class="m">6.85</span>   <span class="m">0.000</span>      <span class="m">1.03698</span>    <span class="m">1.067591</span>
      gender |   .<span class="m">8965847</span>   .<span class="m">1610239</span>    <span class="o">-</span><span class="m">0.61</span>   <span class="m">0.543</span>     .<span class="m">6305479</span>    <span class="m">1.274866</span>
        race |   .<span class="m">8689853</span>   .<span class="m">0496138</span>    <span class="o">-</span><span class="m">2.46</span>   <span class="m">0.014</span>     .<span class="m">7769875</span>     .<span class="m">971876</span>
          dx |   <span class="m">1.036562</span>   .<span class="m">0277149</span>     <span class="m">1.34</span>   <span class="m">0.179</span>     .<span class="m">9836403</span>    <span class="m">1.092331</span>
         bmi |   .<span class="m">9869627</span>   .<span class="m">0165649</span>    <span class="o">-</span><span class="m">0.78</span>   <span class="m">0.434</span>     .<span class="m">9550244</span>    <span class="m">1.019969</span>
    peak_pra |   .<span class="m">9989866</span>   .<span class="m">0034624</span>    <span class="o">-</span><span class="m">0.29</span>   <span class="m">0.770</span>     .<span class="m">9922234</span>    <span class="m">1.005796</span>
     don_ecd |   <span class="m">1.775691</span>   .<span class="m">3403014</span>     <span class="m">3.00</span>   <span class="m">0.003</span>     <span class="m">1.219662</span>    <span class="m">2.585208</span>
    wait_yrs |   .<span class="m">9609635</span>   .<span class="m">0432799</span>    <span class="o">-</span><span class="m">0.88</span>   <span class="m">0.377</span>     .<span class="m">8797726</span>    <span class="m">1.049647</span>
       _cons |   .<span class="m">0143836</span>   .<span class="m">0095138</span>    <span class="o">-</span><span class="m">6.41</span>   <span class="m">0.000</span>     .<span class="m">0039342</span>    .<span class="m">0525873</span>
<span class="o">------------------------------------------------------------------------------</span>
Note: _cons<span class="k"> estimates</span> baseline odds.
z statistic<span class="k"> for</span> gender: <span class="o">-</span>.<span class="m">60781897</span>
p<span class="o">-</span>value<span class="k"> for</span> gender: .<span class="m">54330755</span>
lower bound of <span class="m">95</span>% CI<span class="k"> for</span> gender: .<span class="m">63054792</span>
upper bound of <span class="m">95</span>% CI<span class="k"> for</span> gender: <span class="m">1.2748661</span>

 ( <span class="m">1</span>)  [died]gender = <span class="m">0</span>

<span class="o">------------------------------------------------------------------------------</span>
        died | Odds<span class="k"> ratio</span>   Std.<span class="k"> err</span>.      z    P<span class="o">&gt;</span>|z|     [<span class="m">95</span>%<span class="k"> conf</span>. interval]
<span class="o">-------------+----------------------------------------------------------------</span>
         (<span class="m">1</span>) |   .<span class="m">8965847</span>   .<span class="m">1610239</span>    <span class="o">-</span><span class="m">0.61</span>   <span class="m">0.543</span>     .<span class="m">6305479</span>    <span class="m">1.274866</span>
<span class="o">------------------------------------------------------------------------------</span>
</pre></div>
</div>
<p>Let our second program extract the <code class="docutils literal notranslate"><span class="pre">syntax</span> <span class="pre">varlist</span></code> code that has been introduced</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> mysecond
<span class="k">program</span> define my second
<span class="k">     syntax varlist</span>
<span class="k">     di</span> <span class="s">&quot;This is my second program&quot;</span>
<span class="k">end</span>

mysecond
</pre></div>
</div>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> capture program drop</span> mysecond

.<span class="k"> program</span> define mysecond
<span class="m">1</span>.     <span class="k"> syntax varlist</span>
<span class="m">2</span>.     <span class="k"> di</span> <span class="s">&quot;This is my second	program&quot;</span>
<span class="m">3</span>.<span class="k"> end</span>

. 
. mysecond
<span class="k">varlist</span> required
<span class="nf">r</span>(<span class="m">100</span>);
</pre></div>
</div>
</section>
<section id="mythird">
<h3>3.2.3 mythird<a class="headerlink" href="#mythird" title="Permalink to this heading">#</a></h3>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span><span class="k">capture program drop</span> mythird
<span class="k">program</span> define mysecond
<span class="k">     syntax varlist</span>
<span class="k">	 qui logistic</span> <span class="nv">`varlist&#39;</span>
<span class="k">     di</span> <span class="s">&quot;This is my third program&quot;</span>
<span class="k">	 </span>
<span class="k">end</span>

<span class="k">use</span> transplants,<span class="k"> clear</span>
mythird died gender
</pre></div>
</div>
</section>
<section id="myfourth">
<h3>3.2.4. myfourth<a class="headerlink" href="#myfourth" title="Permalink to this heading">#</a></h3>
<p>capture program drop myfourth
program define myfourth
syntax varlist
qui logistic `varlist’
di e(cmdline)</p>
<p>end</p>
<p>use transplants, clear
mytfourth died gender</p>
<div class="highlight-stata notranslate"><div class="highlight"><pre><span></span>.<span class="k"> capture program drop</span> mythird

.<span class="k"> program</span> define mythird
<span class="m">1</span>.     <span class="k"> syntax varlist</span>
<span class="m">2</span>.         <span class="k"> qui logistic</span> <span class="nv">`varlist&#39;</span>
<span class="m">3</span>.     <span class="k"> di e</span>(cmdline) 
<span class="m">4</span>.          
.<span class="k"> end</span>

. 
.<span class="k"> use</span> transplants,<span class="k"> clear</span>

. mythird died gender
<span class="k">logistic</span> died gender

. 
<span class="k">end</span> of<span class="k"> do</span><span class="o">-</span>file

. 
</pre></div>
</div>
</section>
<section id="myfifth">
<h3>3.2.5. myfifth<a class="headerlink" href="#myfifth" title="Permalink to this heading">#</a></h3>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chapter2.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. Return values, macros, programs</p>
      </div>
    </a>
    <a class="right-next"
       href="chapter4.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">4. Advanced file management</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loops">3.1 Loops</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-numeric-values">3.1.1 Over numeric values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#over-string-values">3.1.2 Over string values</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-syntax">3.2 program syntax</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfirst">3.2.1 myfirst</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mysecond">3.2.2 mysecond</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mythird">3.2.3 mythird</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfourth">3.2.4. myfourth</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#myfifth">3.2.5. myfifth</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Abimereki Muzaale
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>